Построение модели машинного обучения для определения месторождений нефти, разработка которых принесет наибольшую прибыль

Вы работаете в добывающей компании «ГлавРосГосНефть». Нужно решить, где бурить новую скважину.

Вам предоставлены пробы нефти в трёх регионах: в каждом 10 000 месторождений, где измерили качество нефти и объём её запасов. Постройте модель машинного обучения, которая поможет определить регион, где добыча принесёт наибольшую прибыль. Проанализируйте возможную прибыль и риски техникой Bootstrap.

Шаги для выбора локации:

    В избранном регионе ищут месторождения, для каждого определяют значения признаков;
    Строят модель и оценивают объём запасов;
    Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины;
    Прибыль равна суммарной прибыли отобранных месторождений.



<font size="4"><b>План работы</b></font>

    1 Подготовка данных по 3-м регионам;

    2 Обучение и проверка модели для каждого региона:
        - первый регион;
        - второй регион;
        - третий регион;
            
    3 Подготовка к расчёту прибыли:
        - ключевые значения для расчётов в отдельных переменных;
        - рассчет достаточного объёма сырья для безубыточной разработки новой скважины;
        - функция для расчёта прибыли по выбранным скважинам и предсказаниям;
        - подсчет прибыли от разработки выбранных скважин в каждом регионе;
            
    4 Анализ возможной прибыли и рисков техникой Bootstrap для каждого региона:
        - нахождение распределения прибыли в каждом регионе;
        - расчет средней прибыли, 95%-й доверительного интервала и риска убытков для каждого региона;
        
    5 Предложения по выбору региона для разработки скважин
    
    ---
    
    import pandas as pd
import numpy as np
from numpy.random import RandomState
import scipy.stats as st
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import OrdinalEncoder
from sklearn.metrics import mean_squared_error
from sklearn.metrics import mean_absolute_error
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix
from sklearn.metrics import recall_score
from sklearn.metrics import precision_score
from sklearn.metrics import f1_score
from sklearn.metrics import roc_auc_score
from sklearn.metrics import roc_curve
from sklearn.metrics import r2_score









#### Анализ поведения пользователей тарифных планов оператора сотовой связи и подготовка предложений по выбору наилучшего тарифного план

---

Клиентам федерального оператора сотовой связи предлагаются два тарифных плана: «Смарт» и «Ультра». Для корректировки рекламного бюджета необходимо понять, какой тариф приносит больше денег. Имеется небольшая выборка клиентов из 500 пользователей. Необходимо сделать предварительный анализ тарифов: кто они, откуда, каким тарифом пользуются, сколько звонков и сообщений каждый отправил за 2018 год, а также проанализировать поведение клиентов и сделать вывод — какой тариф лучше.

Описание тарифов:

Тариф «Смарт»
- ежемесячная плата: 550 рублей;
- включено 500 минут разговора, 50 сообщений и 15 Гб интернет-трафика;
- стоимость услуг сверх тарифного пакета:
    минута разговора - 3 рубля;
    сообщение - 3 рубля;
    1 Гб интернет-трафика - 200 рублей.

Тариф «Ультра»
- ежемесячная плата: 1950 рублей;
- включено 3000 минут разговора, 1000 сообщений и 30 Гб интернет-трафика;
- стоимость услуг сверх тарифного пакета:
    минута разговора - 1 рубль;
    сообщение - 1 рубль;
    1 Гб интернет-трафика - 150 рублей.

 Оператор всегда округляет секунды до минут, а мегабайты — до гигабайт. Каждый звонок округляется отдельно: даже если он длился всего 1 секунду, будет засчитан как 1 минута. Для веб-трафика отдельные сессии не считаются. Вместо этого общая сумма за месяц округляется в бо́льшую сторону. Если абонент использует 1025 мегабайт в этом месяце, с него возьмут плату за 2 гигабайта.

---

**План работы**

1. Обзор данных.

2. Подготовка данных:

    2.1 Корректировка данных:
    - поиск и исправление дубликатов, аномалий и других ошибок в данных;
    - приведение данных к нужным типам.
        
    2.2 Подготовка пользовательских данных:
    - подсчет количества сделанных звонков и израсходованных минут разговора по месяцам;
    - подсчет количества отправленных сообщений по месяцам;
    - подсчет объема израсходованного интернет-трафика по месяцам;
    - нахождение помесячной выручки с каждого пользователя.
    
3. Анализ данных:
    - анализ оттока клиентов;
    - описание поведения клиентов оператора исходя из тарифа;
    - анализ роста количества клиентов по обоим тарифам;

4. Проверка гипотез:
    - средняя выручка пользователей тарифов «Ультра» и «Смарт» различается;
    - средняя выручка пользователей из Москвы отличается от выручки пользователей из других регионов.

5. Общий вывод.

---

**Используемые библиотеки:**

- pandas
- math
- numpy
- matplotlib
- scipy 
- copy
- seaborn

