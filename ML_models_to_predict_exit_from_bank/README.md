Построение различных моделей машинного обучения для прогнозирования ухода клиентов из банка, повышение качества моделей

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Постройте модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте F1-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.


<font size="4"><b>План работы</b></font>

    1 Подготовка данных

    2 Исследование задачи
        2.1 Подготовим данные для проведения иссделования
            - проведем порядковое кодирование столбцов с категориальными признаками
            - проведем масштабирование (стандартизацию) признаков
        2.2 Разобъем данные на 3 выборки: обучающую, валидационную и тестовую и исследуем баланс классов
            Проведем масштабирование (стандартизацию) признаков 3-х выборок
        2.3 Проведем обучение моделей без учета дисбаланса классов и найдем для каждой модели значение метрик F1 и AUC-ROC
            - Решающее дерево
            - Случайный лес
            - Логистическая регрессия
            
    3 Борьба с дисбалансом
        3.1 Сбалансируем классы с помощью операции 'upsampling'
        3.2 Проведем обучение моделей с учетом баланса классов и найдем для каждой модели значение метрик F1 и AUC-ROC
            - Решающее дерево
            - Случайный лес
            - Логистическая регрессия
            
    4 Тестирование модели

    5 Общий вывод
    

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import OrdinalEncoder
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix
from sklearn.metrics import recall_score
from sklearn.metrics import precision_score
from sklearn.metrics import f1_score
from sklearn.metrics import roc_auc_score
from sklearn.metrics import roc_curve
from sklearn.utils import shuffle



#### Анализ поведения пользователей тарифных планов оператора сотовой связи и подготовка предложений по выбору наилучшего тарифного план

---

Клиентам федерального оператора сотовой связи предлагаются два тарифных плана: «Смарт» и «Ультра». Для корректировки рекламного бюджета необходимо понять, какой тариф приносит больше денег. Имеется небольшая выборка клиентов из 500 пользователей. Необходимо сделать предварительный анализ тарифов: кто они, откуда, каким тарифом пользуются, сколько звонков и сообщений каждый отправил за 2018 год, а также проанализировать поведение клиентов и сделать вывод — какой тариф лучше.

Описание тарифов:

Тариф «Смарт»
- ежемесячная плата: 550 рублей;
- включено 500 минут разговора, 50 сообщений и 15 Гб интернет-трафика;
- стоимость услуг сверх тарифного пакета:
    минута разговора - 3 рубля;
    сообщение - 3 рубля;
    1 Гб интернет-трафика - 200 рублей.

Тариф «Ультра»
- ежемесячная плата: 1950 рублей;
- включено 3000 минут разговора, 1000 сообщений и 30 Гб интернет-трафика;
- стоимость услуг сверх тарифного пакета:
    минута разговора - 1 рубль;
    сообщение - 1 рубль;
    1 Гб интернет-трафика - 150 рублей.

 Оператор всегда округляет секунды до минут, а мегабайты — до гигабайт. Каждый звонок округляется отдельно: даже если он длился всего 1 секунду, будет засчитан как 1 минута. Для веб-трафика отдельные сессии не считаются. Вместо этого общая сумма за месяц округляется в бо́льшую сторону. Если абонент использует 1025 мегабайт в этом месяце, с него возьмут плату за 2 гигабайта.

---

**План работы**

1. Обзор данных.

2. Подготовка данных:

    2.1 Корректировка данных:
    - поиск и исправление дубликатов, аномалий и других ошибок в данных;
    - приведение данных к нужным типам.
        
    2.2 Подготовка пользовательских данных:
    - подсчет количества сделанных звонков и израсходованных минут разговора по месяцам;
    - подсчет количества отправленных сообщений по месяцам;
    - подсчет объема израсходованного интернет-трафика по месяцам;
    - нахождение помесячной выручки с каждого пользователя.
    
3. Анализ данных:
    - анализ оттока клиентов;
    - описание поведения клиентов оператора исходя из тарифа;
    - анализ роста количества клиентов по обоим тарифам;

4. Проверка гипотез:
    - средняя выручка пользователей тарифов «Ультра» и «Смарт» различается;
    - средняя выручка пользователей из Москвы отличается от выручки пользователей из других регионов.

5. Общий вывод.

---

**Используемые библиотеки:**

- pandas
- math
- numpy
- matplotlib
- scipy 
- copy
- seaborn

