Построение модели оптимизации производства, на примере золотодобывающего предприятия

Подготовьте прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Используйте данные с параметрами добычи и очистки.

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.


## План работы

1 Обзор и подготовка данных

    1.1 Обзор данных и изучение общей информации (3 таблицы);
    1.2 Проверка правильности расчета эффективности обогащения;
    1.3 Анализ признаков, недоступных в тестовой выборке;
    1.4 Предобработка данных

2 Анализ данных

    2.1  Анализ изменения концентрация металлов (Au, Ag, Pb) на различных этапах очистки;
    2.2  Сравнение распределения размеров гранул сырья на обучающей и тестовой выборках.
    2.3  Исследуем суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах.

3  Построение модели

    3.1  Напишем функцию для вычисления итоговой sMAPE
    3.2  Обучим разные модели и оценим их качество кросс-валидацией. Выберем лучшую модель и проверим её на тестовой         выборке.

4 Общий вывод


import pandas as pd
import numpy as np
import math
import matplotlib.pyplot as plt
from scipy import stats as st
import copy
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.model_selection import GridSearchCV
from sklearn.metrics import make_scorer
from sklearn.model_selection import cross_val_score
from sklearn.linear_model import LinearRegression
from sklearn.tree import DecisionTreeRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.metrics import mean_absolute_error
from sklearn.dummy import DummyRegressor




#### Анализ поведения пользователей тарифных планов оператора сотовой связи и подготовка предложений по выбору наилучшего тарифного план

---

Клиентам федерального оператора сотовой связи предлагаются два тарифных плана: «Смарт» и «Ультра». Для корректировки рекламного бюджета необходимо понять, какой тариф приносит больше денег. Имеется небольшая выборка клиентов из 500 пользователей. Необходимо сделать предварительный анализ тарифов: кто они, откуда, каким тарифом пользуются, сколько звонков и сообщений каждый отправил за 2018 год, а также проанализировать поведение клиентов и сделать вывод — какой тариф лучше.

Описание тарифов:

Тариф «Смарт»
- ежемесячная плата: 550 рублей;
- включено 500 минут разговора, 50 сообщений и 15 Гб интернет-трафика;
- стоимость услуг сверх тарифного пакета:
    минута разговора - 3 рубля;
    сообщение - 3 рубля;
    1 Гб интернет-трафика - 200 рублей.

Тариф «Ультра»
- ежемесячная плата: 1950 рублей;
- включено 3000 минут разговора, 1000 сообщений и 30 Гб интернет-трафика;
- стоимость услуг сверх тарифного пакета:
    минута разговора - 1 рубль;
    сообщение - 1 рубль;
    1 Гб интернет-трафика - 150 рублей.

 Оператор всегда округляет секунды до минут, а мегабайты — до гигабайт. Каждый звонок округляется отдельно: даже если он длился всего 1 секунду, будет засчитан как 1 минута. Для веб-трафика отдельные сессии не считаются. Вместо этого общая сумма за месяц округляется в бо́льшую сторону. Если абонент использует 1025 мегабайт в этом месяце, с него возьмут плату за 2 гигабайта.

---

**План работы**

1. Обзор данных.

2. Подготовка данных:

    2.1 Корректировка данных:
    - поиск и исправление дубликатов, аномалий и других ошибок в данных;
    - приведение данных к нужным типам.
        
    2.2 Подготовка пользовательских данных:
    - подсчет количества сделанных звонков и израсходованных минут разговора по месяцам;
    - подсчет количества отправленных сообщений по месяцам;
    - подсчет объема израсходованного интернет-трафика по месяцам;
    - нахождение помесячной выручки с каждого пользователя.
    
3. Анализ данных:
    - анализ оттока клиентов;
    - описание поведения клиентов оператора исходя из тарифа;
    - анализ роста количества клиентов по обоим тарифам;

4. Проверка гипотез:
    - средняя выручка пользователей тарифов «Ультра» и «Смарт» различается;
    - средняя выручка пользователей из Москвы отличается от выручки пользователей из других регионов.

5. Общий вывод.

---

**Используемые библиотеки:**

- pandas
- math
- numpy
- matplotlib
- scipy 
- copy
- seaborn
